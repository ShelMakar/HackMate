{% extends "base.html" %}

{% load static %}
{% load ratings %}
{% load i18n %}

{% block links %}
  <link rel="stylesheet" href="{% static 'css/users/profile.css' %}">
{% endblock %}

{% block content %}
  <section class="container profile-section">
    <div class="profile-header">
      <div class="profile-rating">
       <div class="stars">
          {% if request.user.username != profile.user.username %}
	          <h4>Рейтинг {{ rating_count.average|floatformat:1 }}<br>
	          Количество оценок {{ rating_count.count }}
</h4>
          {% else %}
            {% ratings user.profile %}
          {% endif %}
        </div>

      </div>
    </div>
    <div class="profile-avatar">
        {% if user.profile.image %}
          <img src="{{ user.profile.image.url }}" alt="{{ user.username }}" class="avatar">
        {% else %}
          <img src="{% static 'img/default-avatar.jpg' %}" alt="{% trans 'Default Avatar' %}" class="avatar">
        {% endif %}
      </div>
    <div class="profile-info">

      <h1>{{ user.username }}</h1>
      <p class="email">{% trans "Email" %}: <a href="mailto:{{ user.email }}">{{ user.email }}</a></p>

      <div class="profile-details">
        <div class="profile-item">
          {% if user.profile.description %}
            <p><strong>{% trans 'О себе' %}:</strong> {{ user.profile.description }}</p>
          {% else %}
            <p><strong>{% trans 'О себе' %}:</strong> {% trans 'Информация не указана.' %}</p>
          {% endif %}
        </div>

        <div class="profile-item">
          {% if user.profile.birthday %}
            <p><strong>{% trans 'День рождения' %}:</strong> {{ user.profile.birthday }}</p>
          {% else %}
            <p><strong>{% trans 'День рождения' %}:</strong> {% trans 'Информация не указана.' %}</p>
          {% endif %}
        </div>

        <div class="profile-item">
          <p><strong>{% trans 'Дата регистрации' %}:</strong> {{ user.date_joined|date:"d.m.Y" }}</p>
        </div>
      </div>
    </div>

    <div class="links-section">
      <h2>{% trans 'Ссылки на другие сети' %}</h2>

      {% if user.profile.links.exists %}
        <ul class="social-links">
          {% for link in user.profile.links.all %}
            <li>
              <h5>
                <a href="{{ link.url }}" target="_blank" title="{{ link.get_site_type_display }}" class="btn btn-link">
                  <i class="fab {{ link.get_fa_icon_class }} site-icon"></i>
	                {{ link.site_type }}
                </a>
              </h5>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p>{% trans 'Ссылки отсутствуют.' %}</p>
      {% endif %}
    </div>

    {% if is_own_profile %}
      <div class="profile-actions">
        <a href="{% url 'users:profile_edit' %}" class="btn btn-primary">{% trans 'Редактировать профиль' %}</a>
      </div>
    {% endif %}
  <h2>Завершённые вакансии</h2>
{% for vacancy in finished_vacancies %}
    <div class="vacancy-card">
        <h3 class="vacancy-title">
            <a href="{% url 'vacancies:vacancy_detail' pk=vacancy.pk %}">
                {{ vacancy.title }}
            </a>
        </h3>
        <p class="vacancy-description">{{ vacancy.description }}</p>
        <p class="vacancy-deadline">Дата хакатона: {{ vacancy.hackaton_date|date:"d.m.Y" }}</p>
    </div>
{% empty %}
    <p class="no-vacancies">У пользователя {{ profile_user.username }} нет завершённых вакансий.</p>
{% endfor %}

  </section>

  <link rel="stylesheet" href="{% static 'star-ratings/css/star-ratings.css' %}">
  <script type="text/javascript" src="{% static 'star-ratings/js/dist/star-ratings.min.js' %}"></script>
{% endblock %}
